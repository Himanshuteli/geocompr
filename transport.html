<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Geocomputation with R</title>
  <meta name="description" content="Forthcoming book on geographic data with R.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Geocomputation with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://geocompr.robinlovelace.net" />
  
  <meta property="og:description" content="Forthcoming book on geographic data with R." />
  <meta name="github-repo" content="Robinlovelace/geocompr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Geocomputation with R" />
  
  <meta name="twitter:description" content="Forthcoming book on geographic data with R." />
  

<meta name="author" content="Robin Lovelace, Jakub Nowosad, Jannes Muenchow">


<meta name="date" content="2018-01-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="location.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<link href="libs/leaflet-0.7.7/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-0.7.7/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<link href="libs/leaflet-label-0.2.2/leaflet.label.css" rel="stylesheet" />
<script src="libs/leaflet-label-0.2.2/leaflet.label.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4leaflet.js"></script>
<script src="libs/leaflet-binding-1.1.0/leaflet.js"></script>
<script src="libs/leaflet-providers-1.0.27/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-1.1.0/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet" />
<script src="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99618359-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Geocomputation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#development"><i class="fa fa-check"></i>Development</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reproducibility"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-is-geocomputation"><i class="fa fa-check"></i><b>1.1</b> What is geocomputation?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#why-geocomputation-with-r"><i class="fa fa-check"></i><b>1.2</b> Why Geocomputation with R?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#software-for-geocomputation"><i class="fa fa-check"></i><b>1.3</b> Software for geocomputation</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#rs-spatial-ecosystem"><i class="fa fa-check"></i><b>1.4</b> R’s spatial ecosystem</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#the-history-of-r-spatial"><i class="fa fa-check"></i><b>1.5</b> The history of R-spatial</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spatial-class.html"><a href="spatial-class.html"><i class="fa fa-check"></i><b>2</b> Geographic data in R</a><ul>
<li class="chapter" data-level="" data-path="spatial-class.html"><a href="spatial-class.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="2.1" data-path="spatial-class.html"><a href="spatial-class.html#vector-data"><i class="fa fa-check"></i><b>2.1</b> Vector data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="spatial-class.html"><a href="spatial-class.html#intro-sf"><i class="fa fa-check"></i><b>2.1.1</b> An introduction to simple features</a></li>
<li class="chapter" data-level="2.1.2" data-path="spatial-class.html"><a href="spatial-class.html#why-simple-features"><i class="fa fa-check"></i><b>2.1.2</b> Why simple features?</a></li>
<li class="chapter" data-level="2.1.3" data-path="spatial-class.html"><a href="spatial-class.html#basic-map"><i class="fa fa-check"></i><b>2.1.3</b> Basic map making</a></li>
<li class="chapter" data-level="2.1.4" data-path="spatial-class.html"><a href="spatial-class.html#base-args"><i class="fa fa-check"></i><b>2.1.4</b> Base plot arguments</a></li>
<li class="chapter" data-level="2.1.5" data-path="spatial-class.html"><a href="spatial-class.html#sf-classes"><i class="fa fa-check"></i><b>2.1.5</b> Simple feature classes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="spatial-class.html"><a href="spatial-class.html#raster-data"><i class="fa fa-check"></i><b>2.2</b> Raster data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="spatial-class.html"><a href="spatial-class.html#an-introduction-to-raster"><i class="fa fa-check"></i><b>2.2.1</b> An introduction to raster</a></li>
<li class="chapter" data-level="2.2.2" data-path="spatial-class.html"><a href="spatial-class.html#basic-map-making"><i class="fa fa-check"></i><b>2.2.2</b> Basic map making</a></li>
<li class="chapter" data-level="2.2.3" data-path="spatial-class.html"><a href="spatial-class.html#raster-classes"><i class="fa fa-check"></i><b>2.2.3</b> Raster classes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="spatial-class.html"><a href="spatial-class.html#crs-intro"><i class="fa fa-check"></i><b>2.3</b> Coordinate Reference Systems</a><ul>
<li class="chapter" data-level="2.3.1" data-path="spatial-class.html"><a href="spatial-class.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>2.3.1</b> Geographic coordinate systems</a></li>
<li class="chapter" data-level="2.3.2" data-path="spatial-class.html"><a href="spatial-class.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>2.3.2</b> Projected coordinate systems</a></li>
<li class="chapter" data-level="2.3.3" data-path="spatial-class.html"><a href="spatial-class.html#crs-in-r"><i class="fa fa-check"></i><b>2.3.3</b> CRSs in R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="spatial-class.html"><a href="spatial-class.html#units"><i class="fa fa-check"></i><b>2.4</b> Units</a></li>
<li class="chapter" data-level="2.5" data-path="spatial-class.html"><a href="spatial-class.html#ex2"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="attr.html"><a href="attr.html"><i class="fa fa-check"></i><b>3</b> Attribute operations</a><ul>
<li class="chapter" data-level="" data-path="attr.html"><a href="attr.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="3.1" data-path="attr.html"><a href="attr.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="attr.html"><a href="attr.html#vector-attribute-manipulation"><i class="fa fa-check"></i><b>3.2</b> Vector attribute manipulation</a><ul>
<li class="chapter" data-level="3.2.1" data-path="attr.html"><a href="attr.html#vector-attribute-subsetting"><i class="fa fa-check"></i><b>3.2.1</b> Vector attribute subsetting</a></li>
<li class="chapter" data-level="3.2.2" data-path="attr.html"><a href="attr.html#vector-attribute-aggregation"><i class="fa fa-check"></i><b>3.2.2</b> Vector attribute aggregation</a></li>
<li class="chapter" data-level="3.2.3" data-path="attr.html"><a href="attr.html#vector-attribute-joining"><i class="fa fa-check"></i><b>3.2.3</b> Vector attribute joining</a></li>
<li class="chapter" data-level="3.2.4" data-path="attr.html"><a href="attr.html#vec-attr-creation"><i class="fa fa-check"></i><b>3.2.4</b> Creating attributes and removing spatial information</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="attr.html"><a href="attr.html#manipulating-raster-objects"><i class="fa fa-check"></i><b>3.3</b> Manipulating raster objects</a><ul>
<li class="chapter" data-level="3.3.1" data-path="attr.html"><a href="attr.html#raster-subsetting"><i class="fa fa-check"></i><b>3.3.1</b> Raster subsetting</a></li>
<li class="chapter" data-level="3.3.2" data-path="attr.html"><a href="attr.html#summarizing-raster-objects"><i class="fa fa-check"></i><b>3.3.2</b> Summarizing raster objects</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="attr.html"><a href="attr.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-operations.html"><a href="spatial-operations.html"><i class="fa fa-check"></i><b>4</b> Spatial operations</a><ul>
<li class="chapter" data-level="" data-path="spatial-operations.html"><a href="spatial-operations.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="spatial-operations.html"><a href="spatial-operations.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-vec"><i class="fa fa-check"></i><b>4.2</b> Spatial operations on vector data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-subsetting"><i class="fa fa-check"></i><b>4.2.1</b> Spatial subsetting</a></li>
<li class="chapter" data-level="4.2.2" data-path="spatial-operations.html"><a href="spatial-operations.html#topological-relations"><i class="fa fa-check"></i><b>4.2.2</b> Topological relations</a></li>
<li class="chapter" data-level="4.2.3" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-joining"><i class="fa fa-check"></i><b>4.2.3</b> Spatial joining</a></li>
<li class="chapter" data-level="4.2.4" data-path="spatial-operations.html"><a href="spatial-operations.html#non-overlapping-joins"><i class="fa fa-check"></i><b>4.2.4</b> Non-overlapping joins</a></li>
<li class="chapter" data-level="4.2.5" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-aggr"><i class="fa fa-check"></i><b>4.2.5</b> Spatial data aggregation</a></li>
<li class="chapter" data-level="4.2.6" data-path="spatial-operations.html"><a href="spatial-operations.html#distance-relations"><i class="fa fa-check"></i><b>4.2.6</b> Distance relations</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-ras"><i class="fa fa-check"></i><b>4.3</b> Spatial operations on raster data</a><ul>
<li class="chapter" data-level="4.3.1" data-path="attr.html"><a href="attr.html#raster-subsetting"><i class="fa fa-check"></i><b>4.3.1</b> Spatial subsetting</a></li>
<li class="chapter" data-level="4.3.2" data-path="spatial-operations.html"><a href="spatial-operations.html#map-algebra"><i class="fa fa-check"></i><b>4.3.2</b> Map algebra</a></li>
<li class="chapter" data-level="4.3.3" data-path="spatial-operations.html"><a href="spatial-operations.html#local-operations"><i class="fa fa-check"></i><b>4.3.3</b> Local operations</a></li>
<li class="chapter" data-level="4.3.4" data-path="spatial-operations.html"><a href="spatial-operations.html#focal-operations"><i class="fa fa-check"></i><b>4.3.4</b> Focal operations</a></li>
<li class="chapter" data-level="4.3.5" data-path="spatial-operations.html"><a href="spatial-operations.html#zonal-operations"><i class="fa fa-check"></i><b>4.3.5</b> Zonal operations</a></li>
<li class="chapter" data-level="4.3.6" data-path="spatial-operations.html"><a href="spatial-operations.html#global-operations-and-distances"><i class="fa fa-check"></i><b>4.3.6</b> Global operations and distances</a></li>
<li class="chapter" data-level="4.3.7" data-path="spatial-operations.html"><a href="spatial-operations.html#merging-rasters"><i class="fa fa-check"></i><b>4.3.7</b> Merging rasters</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="spatial-operations.html"><a href="spatial-operations.html#exercises-2"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transform.html"><a href="transform.html"><i class="fa fa-check"></i><b>5</b> Geometric operations</a><ul>
<li class="chapter" data-level="" data-path="transform.html"><a href="transform.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="5.1" data-path="transform.html"><a href="transform.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="transform.html"><a href="transform.html#reproj-geo-data"><i class="fa fa-check"></i><b>5.2</b> Reprojecting geographic data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="transform.html"><a href="transform.html#which-crs-to-use"><i class="fa fa-check"></i><b>5.2.1</b> Which CRS to use?</a></li>
<li class="chapter" data-level="5.2.2" data-path="transform.html"><a href="transform.html#reproj-vec-geom"><i class="fa fa-check"></i><b>5.2.2</b> Reprojecting vector geometries</a></li>
<li class="chapter" data-level="5.2.3" data-path="transform.html"><a href="transform.html#reprojecting-raster-geometries"><i class="fa fa-check"></i><b>5.2.3</b> Reprojecting raster geometries</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="transform.html"><a href="transform.html#geo-vec"><i class="fa fa-check"></i><b>5.3</b> Geometric operations on vector data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="transform.html"><a href="transform.html#simplification"><i class="fa fa-check"></i><b>5.3.1</b> Simplification</a></li>
<li class="chapter" data-level="5.3.2" data-path="transform.html"><a href="transform.html#centroids"><i class="fa fa-check"></i><b>5.3.2</b> Centroids</a></li>
<li class="chapter" data-level="5.3.3" data-path="transform.html"><a href="transform.html#buffers"><i class="fa fa-check"></i><b>5.3.3</b> Buffers</a></li>
<li class="chapter" data-level="5.3.4" data-path="transform.html"><a href="transform.html#affine-transformations"><i class="fa fa-check"></i><b>5.3.4</b> Affine transformations</a></li>
<li class="chapter" data-level="5.3.5" data-path="transform.html"><a href="transform.html#clipping"><i class="fa fa-check"></i><b>5.3.5</b> Clipping</a></li>
<li class="chapter" data-level="5.3.6" data-path="transform.html"><a href="transform.html#geometry-unions"><i class="fa fa-check"></i><b>5.3.6</b> Geometry unions</a></li>
<li class="chapter" data-level="5.3.7" data-path="transform.html"><a href="transform.html#type-transformations"><i class="fa fa-check"></i><b>5.3.7</b> Type transformations</a></li>
<li class="chapter" data-level="5.3.8" data-path="transform.html"><a href="transform.html#rasterization"><i class="fa fa-check"></i><b>5.3.8</b> Rasterization</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="transform.html"><a href="transform.html#geo-ras"><i class="fa fa-check"></i><b>5.4</b> Geometric operations on raster data</a><ul>
<li class="chapter" data-level="5.4.1" data-path="transform.html"><a href="transform.html#ras-agg"><i class="fa fa-check"></i><b>5.4.1</b> Aggregation</a></li>
<li class="chapter" data-level="5.4.2" data-path="transform.html"><a href="transform.html#raster-alignment"><i class="fa fa-check"></i><b>5.4.2</b> Raster alignment</a></li>
<li class="chapter" data-level="5.4.3" data-path="transform.html"><a href="transform.html#vectorization"><i class="fa fa-check"></i><b>5.4.3</b> Vectorization</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="transform.html"><a href="transform.html#exercises-3"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="read-write.html"><a href="read-write.html"><i class="fa fa-check"></i><b>6</b> Geographic data I/O</a><ul>
<li class="chapter" data-level="" data-path="read-write.html"><a href="read-write.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="6.1" data-path="read-write.html"><a href="read-write.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="read-write.html"><a href="read-write.html#retrieving-data"><i class="fa fa-check"></i><b>6.2</b> Retrieving open data</a></li>
<li class="chapter" data-level="6.3" data-path="read-write.html"><a href="read-write.html#file-formats"><i class="fa fa-check"></i><b>6.3</b> File formats</a></li>
<li class="chapter" data-level="6.4" data-path="read-write.html"><a href="read-write.html#data-input"><i class="fa fa-check"></i><b>6.4</b> Data Input (I)</a><ul>
<li class="chapter" data-level="6.4.1" data-path="read-write.html"><a href="read-write.html#vector-data-1"><i class="fa fa-check"></i><b>6.4.1</b> Vector data</a></li>
<li class="chapter" data-level="6.4.2" data-path="read-write.html"><a href="read-write.html#raster-data-1"><i class="fa fa-check"></i><b>6.4.2</b> Raster data</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="read-write.html"><a href="read-write.html#data-output"><i class="fa fa-check"></i><b>6.5</b> Data output (O)</a><ul>
<li class="chapter" data-level="6.5.1" data-path="read-write.html"><a href="read-write.html#vector-data-2"><i class="fa fa-check"></i><b>6.5.1</b> Vector data</a></li>
<li class="chapter" data-level="6.5.2" data-path="read-write.html"><a href="read-write.html#raster-data-2"><i class="fa fa-check"></i><b>6.5.2</b> Raster data</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="read-write.html"><a href="read-write.html#visual-outputs"><i class="fa fa-check"></i><b>6.6</b> Visual outputs</a></li>
<li class="chapter" data-level="6.7" data-path="read-write.html"><a href="read-write.html#exercises-4"><i class="fa fa-check"></i><b>6.7</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Basic applications</b></span></li>
<li class="chapter" data-level="7" data-path="location.html"><a href="location.html"><i class="fa fa-check"></i><b>7</b> Location analysis</a><ul>
<li class="chapter" data-level="" data-path="location.html"><a href="location.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="7.1" data-path="location.html"><a href="location.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="location.html"><a href="location.html#case-study"><i class="fa fa-check"></i><b>7.2</b> Case study: bike shops in Germany</a><ul>
<li class="chapter" data-level="7.2.1" data-path="location.html"><a href="location.html#tidy-the-input-data"><i class="fa fa-check"></i><b>7.2.1</b> Tidy the input data</a></li>
<li class="chapter" data-level="7.2.2" data-path="location.html"><a href="location.html#create-census-rasters"><i class="fa fa-check"></i><b>7.2.2</b> Create census rasters</a></li>
<li class="chapter" data-level="7.2.3" data-path="location.html"><a href="location.html#define-metropolitan-areas"><i class="fa fa-check"></i><b>7.2.3</b> Define metropolitan areas</a></li>
<li class="chapter" data-level="7.2.4" data-path="location.html"><a href="location.html#points-of-interest"><i class="fa fa-check"></i><b>7.2.4</b> Points of interest</a></li>
<li class="chapter" data-level="7.2.5" data-path="location.html"><a href="location.html#identifying-suitable-locations"><i class="fa fa-check"></i><b>7.2.5</b> Identifying suitable locations</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="location.html"><a href="location.html#discussion-and-next-steps"><i class="fa fa-check"></i><b>7.3</b> Discussion and next steps</a></li>
<li class="chapter" data-level="7.4" data-path="location.html"><a href="location.html#exercises-5"><i class="fa fa-check"></i><b>7.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="transport.html"><a href="transport.html"><i class="fa fa-check"></i><b>8</b> Transport applications</a><ul>
<li class="chapter" data-level="" data-path="transport.html"><a href="transport.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="8.1" data-path="transport.html"><a href="transport.html#introduction-5"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="transport.html"><a href="transport.html#bris-case"><i class="fa fa-check"></i><b>8.2</b> A case study of Bristol</a></li>
<li class="chapter" data-level="8.3" data-path="transport.html"><a href="transport.html#transport-zones"><i class="fa fa-check"></i><b>8.3</b> Transport zones</a></li>
<li class="chapter" data-level="8.4" data-path="transport.html"><a href="transport.html#desire-lines"><i class="fa fa-check"></i><b>8.4</b> Desire lines</a></li>
<li class="chapter" data-level="8.5" data-path="transport.html"><a href="transport.html#routes"><i class="fa fa-check"></i><b>8.5</b> Routes</a></li>
<li class="chapter" data-level="8.6" data-path="transport.html"><a href="transport.html#nodes-on-the-transport-system"><i class="fa fa-check"></i><b>8.6</b> Nodes on the transport system</a></li>
<li class="chapter" data-level="8.7" data-path="transport.html"><a href="transport.html#route-networks"><i class="fa fa-check"></i><b>8.7</b> Route networks</a></li>
<li class="chapter" data-level="8.8" data-path="transport.html"><a href="transport.html#future-directions-of-travel"><i class="fa fa-check"></i><b>8.8</b> Future directions of travel</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://robinlovelace.net/">Robin Lovelace</a></li>
<li><a href="https://nowosad.github.io/">Jakub Nowosad</a></li>
<li><a href="http://www.geographie.uni-jena.de/en/Muenchow.html">Jannes Muenchow</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Geocomputation with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="transport" class="section level1">
<h1><span class="header-section-number">8</span> Transport applications</h1>
<div id="prerequisites-6" class="section level2 unnumbered">
<h2>Prerequisites</h2>
<ul>
<li>This chapter requires the following packages to be loaded (it also uses <strong>osmdata</strong> and <strong>nabor</strong> although these do not need to be loaded):</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sf)
<span class="kw">library</span>(stplanr)
<span class="kw">library</span>(tidyverse)</code></pre></div>
</div>
<div id="introduction-5" class="section level2">
<h2><span class="header-section-number">8.1</span> Introduction</h2>
<p>In no other sector is geographic space more tangible than transport. It is the effort of moving, particularly between places that are far apart, that led to the ‘first law’ of geography defined by Waldo Tobler in 1970 as follows <span class="citation">(Miller <a href="#ref-miller_toblers_2004">2004</a>)</span>:</p>
<blockquote>
<p>Everything is related to everything else, but near things are more related than distant things</p>
</blockquote>
<p>This ‘law’ applies to phenomena as diverse as friendship networks and ecological diversity and can be explained by the costs of transport — in terms of time, energy and money. These costs are known as the ‘friction of distance’. Thus transport technologies disrupt geographic relationships from the perspective of mobile humans and goods: “the purpose of transportation is to overcome space” <span class="citation">(Rodrigue, Comtois, and Slack <a href="#ref-rodrigue_geography_2013">2013</a>)</span>.</p>
<p>Transport is an inherently geospatial activity. It involves traversing continuous geographic space between A and B, and infinite localities in between. It is therefore unsurprising that transport researchers have long turned to geocomputational methods to understand movement patterns and that transport problems are a motivator of geocomputational methods.</p>
<p>This chapter provides an introduction to geographic analysis of transport systems. We will explore how movement patterns can be understood at multiple geographic levels, including:</p>
<ul>
<li><strong>Areal units</strong>: transport can be understood simply in terms of zonal aggregates such as the main mode and average distance of trips made people living in a particular zone.</li>
<li><strong>Desire lines</strong>: straight lines that represent ‘origin-destination’ data that records how many people travel (or could travel) between places (points or zones) in geographic space.</li>
<li><strong>Routes</strong>: these are circuitous (non-straight) routes, typically representing the ‘optimal’ path along the route network between origins and destinations along the desire lines defined in the previous bullet point.</li>
<li><strong>Nodes</strong>: these are points in the transport system that can represent common origins and destinations (e.g. with one centroid per zone) and public transport stations such as bus stops and rail stations.</li>
<li><strong>Route networks</strong>: these represent the system of roads, paths and other linear features in an area. They can be represented as purely geographic entities or as a graph. Their features are segments which can be assigned values representing ‘flow’, the number of people expected to use a particular street or path.</li>
</ul>
<p>The lowest but hardest-to-model level in transport systems is <strong>agents</strong>, mobile entities like you and me. Some models built using software such as <a href="http://www.matsim.org/">MATSim</a> can effectively captue the dynamics of transport systems using an agent-based modelling (ABM) approach at high spatial and temporal resolution. These tend to be complex and computationally demanding <span class="citation">(Horni, Nagel, and Axhausen <a href="#ref-horni_multi-agent_2016">2016</a>)</span>, meaning they are inaccessible to most people. Beyond geographic levels and agents, the basic unit of analysis in most transport models is the <strong>trip</strong>, a single purpose journey from an groin ‘A’ to a destination ‘B’ <span class="citation">(Hollander <a href="#ref-hollander_transport_2016">2016</a>)</span>. Trips join-up the different levels of transport systems: they are usually represented as <em>desire lines</em> connecting <em>zone</em> centroids (<em>nodes</em>), they can be allocated onto the <em>route network</em> as <em>routes</em>, and are made by people who can be represented as <em>agents</em>.</p>
<p>Another complication is time. Although many trips are regular and predictable — such as the daily commute to work — transport systems are dynamic and constantly evolving at many levels of temporal resolution. The purpose of geographic transport modeling can be interpreted as simplifying this complexity in a way that captures the essence of transport problems. Selecting an appropriate level of geographic analysis can help simplify this complexity, to capture the essence of a transport system without loosing its most important features and variables <span class="citation">(Hollander <a href="#ref-hollander_transport_2016">2016</a>)</span>.</p>
<p>Typically models are designed to solve a particular problem. For this reason this chapter is based around a policy scenario that asks: how to increase walking and cycling in the city of Bristol? The case study city is a coastal settlement in the West of England, described in the next section.</p>
<!-- Idea: make it about reducing CO2 emissions instead. Thoughts? + Multi-model - more complex -->
</div>
<div id="bris-case" class="section level2">
<h2><span class="header-section-number">8.2</span> A case study of Bristol</h2>
<p>The case study used for this chapter is a city on the west of England, around 30 km East of the Welsh capital Cardiff. An overview of the region’s transport network is illustrated in Figure <a href="transport.html#fig:bristol">8.1</a>, which shows a diversity of transport infrastructure, for cycling, public transport, and private motor vehicle.</p>
<div class="figure" style="text-align: center"><span id="fig:bristol"></span>
<img src="https://user-images.githubusercontent.com/1825120/34452756-985267de-ed3e-11e7-9f59-fda1f3852253.png" alt="Overview map of the case study region surrounding Bristol. The transport network is represented as colored lines for active (green), public (railways, black) and private motor (red) modes of travel. The blue borders represent the inner city boundary and the larger Travel To Work Area (TTWA)."  />
<p class="caption">
Figure 8.1: Overview map of the case study region surrounding Bristol. The transport network is represented as colored lines for active (green), public (railways, black) and private motor (red) modes of travel. The blue borders represent the inner city boundary and the larger Travel To Work Area (TTWA).
</p>
</div>
<p>Bristol is the 10<sup>th</sup> largest city council in England, with a population of half a million people, although its travel catchment area is larger (see section <a href="transport.html#transport-zones">8.3</a>). It has a vibrant economy with aerospace, media, financial service and tourism companies, alongside two major universities. Bristol has high average income per capita but contains areas of severe deprivation <span class="citation">(Bristol City Council <a href="#ref-bristol_city_council_deprivation_2015">2015</a>)</span>.</p>
<p>In terms of transport, Bristol is well served by rail and road links, and has a relatively high level of active travel. 19% of its citizens cycle and 88% walk at least once per month according to the <a href="https://www.gov.uk/government/statistical-data-sets/how-often-and-time-spent-walking-and-cycling-at-local-authority-level-cw010#table-cw0103">Active People Survey</a> (the national average is 15% and 81% respectively). 8% of the population reported cycling to work in the 2011 census, compared with only 3% nationwide.</p>
<p>Despite impressive walking and cycling statistics, the city has a major congestion problem. Part of the solution is to continue increase the proportion of trips made by cycling. Cycling has a greater potential to replace car trips than walking because of the speed of this mode, around 3-4 times faster than walking (with typical <a href="https://en.wikipedia.org/wiki/Bicycle_performance">speeds</a> of 15-20 km/h vs 4-6 km/h for walking). There is therefore a <a href="http://www.cyclingweekly.com/news/interview-bristols-mayor-george-ferguson-24114">plan</a> to double the mode share of cycling by 2020.</p>
<p>In this policy context the aim of this chapter, beyond demonstrating how geocomputation with R can be used to support sustainable transport planning, is to provide evidence for decision-makers in Bristol to decide how best to increase the mode share of walking and cycling in particular in the city. This high-level aim will be met via the following objectives:</p>
<ul>
<li>Describe the geographical pattern of transport behavior in the city.</li>
<li>Identify key nodes and potential bottlenecks where walking and cycling potential is likely to be highest.</li>
<li>Analyze travel ‘desire lines’ in the city to identify those with greatest potential for modal shift.</li>
<li>Building on the desire-line level analysis, identify which routes would most benefit from having dedicated cycleways and improved provision for pedestrians.</li>
</ul>
<p>To get the wheels rolling on the practical aspects of this chapter, we begin by loading zonal data on travel patterns. These zone-level data are small but often vital for gaining a basic understanding of a settlement’s overall transport system.</p>
</div>
<div id="transport-zones" class="section level2">
<h2><span class="header-section-number">8.3</span> Transport zones</h2>
<p>Although transport systems are primarily based on linear features and nodes — including pathways and stations — it often makes sense to start with areal data. Three types of zone will typically be of particular interest: the study region, origin zones (typically residential areas), and destination zones (which are often the same as the origin zones).</p>
<p>The simplest way to define a study area is often the first matching boundary returned by OpenStreetMap, which can be obtained using <strong>osmdata</strong> as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">region_bb =<span class="st"> </span>osmdata::<span class="kw">getbb</span>(<span class="st">&quot;Bristol&quot;</span>, <span class="dt">format_out =</span> <span class="st">&quot;sf_polygon&quot;</span>)</code></pre></div>
<p>The result is an <code>sf</code> object representing the bounds of the largest matching city region, either a rectangular polygon of the bounding box or detailed polygonal boundary.<a href="#fn47" class="footnoteRef" id="fnref47"><sup>47</sup></a> In this case the command returns a detailed polygon representing official boundary of Bristol (see the inner blue boundary in Figure <a href="transport.html#fig:bristol">8.1</a>). This approach is not always appropriate, because boundaries in OSM often differ from boundaries used by local authorities. Furthermore, even official boundaries returned by OSM may not be appropriate for transport research because they bear little relation to where people travel.</p>
<p>Travel to Work Areas (TTWAs) overcome this issue by creating a zoning system analogous to hydrological watersheds. TTWAs were first defined as contiguous zones within which 75% of the population travels work <span class="citation">(Coombes, Green, and Openshaw <a href="#ref-coombes_efficient_1986">1986</a>)</span>, and this is the definition used in this chapter. Because Bristol is a major employer attracting travel from surrounding towns, its TTWA — loaded in the command below — is substantially larger than the city bounds (see Figure <a href="transport.html#fig:bristol">8.1</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">region_ttwa =<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;extdata/bristol-ttwa.rds&quot;</span>)</code></pre></div>
<p>The origin and destination zones used in this chapter are the same: officially defined zones of intermediate geographic resolution (their <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/bulletins/annualsmallareapopulationestimates/2014-10-23">official</a> name is Middle layer Super Output Areas or MSOAs). Each house around 8,000 people. Such administrative zones can provide vital context to transport analysis, such as the type of people who benefit particular interventions.</p>
<p>The geographic resolution of these zones is important: small zones with high geographic resolution are usually preferable but their high number in large regions can have consequences for processing (especially for origin-destination analysis in which the number of possibilities increases as a non-linear function of the number of zones). Another issue with small zones is related to anonymity rules: more socio-demographic variables are often available for large zones.</p>
<p>The 102 zones used are illustrated in Figure <a href="transport.html#fig:zones">8.2</a>. These can be loaded from the <code>exdata</code> folder of the book:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zones =<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;extdata/bristol-zones.rds&quot;</span>)</code></pre></div>
<p>This dataset provides a useful basis for dividing-up space into meaningful chunks, with each zone housing a similar number of people. However at present the dataset contains no attribute data, other than the zone name and zone code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(zones)
<span class="co">#&gt; [1] &quot;geo_code&quot; &quot;name&quot;     &quot;geometry&quot;</span></code></pre></div>
<p>Chapter <a href="attr.html#attr">3</a> demonstrated how to join attribute data onto geographic variables. This is a common task usually involved joining a table containing official zonal statistics to a geographic object via a shared key variable (<a href="https://www.ons.gov.uk/help/localstatistics">ons.gov.uk</a> contains datasets at various geographic levels in the UK, for example). For this chapter an additional stage is needed: aggregation of the origin-destination (OD) data to the level of residential zones (the nature of this OD dataset is described in more detail in section <a href="transport.html#desire-lines">8.4</a>), as demonstrated below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">od =<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;extdata/bristol-od.rds&quot;</span>)
zones_attr =<span class="st"> </span><span class="kw">group_by</span>(od, o) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_if</span>(is.numeric, sum) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">geo_code =</span> o)</code></pre></div>
<p>What just happened? After the <code>od</code> dataset was read-in, the chained operation:</p>
<ul>
<li>Grouped the data by zone of origin (contained in the column <code>o</code>).</li>
<li>Aggregated the variables in the <code>od</code> dataset <em>if</em> they were numeric, to find the total number of people living in each zone by mode of transport.<a href="#fn48" class="footnoteRef" id="fnref48"><sup>48</sup></a></li>
<li>Renamed the grouping variable <code>o</code> so it matches the ID column <code>geo_code</code> in the <code>zones</code> object.</li>
</ul>
<p>The resulting object <code>zones_attr</code> is a data frame with rows representing zones and an ID variable. We can verify that the IDs match the zone dataset with the <code>%in%</code> operator as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(zones_attr$geo_code %in%<span class="st"> </span>zones$geo_code)
<span class="co">#&gt;    Mode    TRUE </span>
<span class="co">#&gt; logical     102</span></code></pre></div>
<p>The attribute data is now in a form that can be joined onto the zones. This is done using the joining function <code>left_join()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zones =<span class="st"> </span><span class="kw">left_join</span>(zones, zones_attr)
<span class="co">#&gt; Joining, by = &quot;geo_code&quot;</span>
<span class="kw">sum</span>(zones$all)
<span class="co">#&gt; [1] 238805</span>
<span class="kw">names</span>(zones)
<span class="co">#&gt; [1] &quot;geo_code&quot;   &quot;name&quot;       &quot;all&quot;        &quot;bicycle&quot;    &quot;foot&quot;      </span>
<span class="co">#&gt; [6] &quot;car_driver&quot; &quot;train&quot;      &quot;geometry&quot;</span></code></pre></div>
<p>The result is an updated <code>zones</code> dataset that contains new columns representing the total number of trips originating in each zone in the study area (almost 1/4 of a million) and their mode of travel (by bicycle, foot, car and train). The geographic distribution of trip origins is illustrated in the left-hand map in Figure <a href="transport.html#fig:zones">8.2</a>. This shows that most zones have between 0 and 4,000 trips originating from them in the study area. More trips are made by people living near the center of Bristol and fewer on the outskirts. Why is this? Remember that we are only dealing trips within the study region: low trip numbers in the outskirts of the region can be explained by the fact that many people in these peripheral zones will travel to other regions.</p>
<p>In the same way that OD datasets can be aggregated to the zone of origin, they can also be aggregated to provide information about destination zones. People tend to gravitate towards central places. This explains why the spatial distribution represented in the right panel in Figure <a href="transport.html#fig:zones">8.2</a> is relatively uneven, with the most common destination zones concentrated in Bristol city center. The updated <code>zones</code> dataset, which contains a new column reporting number of trip destinations by any mode, is created as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zones =<span class="st"> </span><span class="kw">group_by</span>(od, d) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_if</span>(is.numeric, sum) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="dt">geo_code =</span> d, <span class="dt">all_dest =</span> all) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">inner_join</span>(zones, ., <span class="dt">by =</span> <span class="st">&quot;geo_code&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:zones"></span>
<img src="figures/zones-1.png" alt="Number of trips (commuters) living and working in the region. The left map shows zone of origin of commute trips; the right map shows zone of destination." width="576" />
<p class="caption">
Figure 8.2: Number of trips (commuters) living and working in the region. The left map shows zone of origin of commute trips; the right map shows zone of destination.
</p>
</div>
</div>
<div id="desire-lines" class="section level2">
<h2><span class="header-section-number">8.4</span> Desire lines</h2>
<p>Unlike zones, which represent trip origins and destinations, desire lines represent where people <em>desire</em> to go between zones. If it were not for obstacles such as buildings and windy roads, people would travel in a ‘bee-line’ from one place to the next, explaining why desire lines are straight (we will see how to convert desire lines into routes in the next section).</p>
<p>We have already loaded data representing desire lines in the dataset <code>od</code>. This origin-destination (OD) data frame object represents the number of people traveling between the zone represented in <code>o</code> and <code>d</code>, as illustrated in Table <a href="transport.html#tab:od">8.1</a>. This subset of the data was using attribute operations described in Chapter <a href="attr.html#attr">3</a>, to arrange the OD data by all trips and then filter-out only the top 5:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">od_top5 =<span class="st"> </span><span class="kw">arrange</span>(od, <span class="kw">desc</span>(all)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">5</span>, <span class="dt">wt =</span> all)</code></pre></div>
<table>
<caption><span id="tab:od">Table 8.1: </span>Sample of the origin-destination data stored in the data frame object <code>od</code>. These represent the top 5 most common desire lines between zones in the study area.</caption>
<thead>
<tr class="header">
<th align="left">o</th>
<th align="left">d</th>
<th align="right">all</th>
<th align="right">bicycle</th>
<th align="right">foot</th>
<th align="right">car_driver</th>
<th align="right">train</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">E02003043</td>
<td align="left">E02003043</td>
<td align="right">1493</td>
<td align="right">66</td>
<td align="right">1296</td>
<td align="right">64</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">E02003047</td>
<td align="left">E02003043</td>
<td align="right">1300</td>
<td align="right">287</td>
<td align="right">751</td>
<td align="right">148</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">E02003031</td>
<td align="left">E02003043</td>
<td align="right">1221</td>
<td align="right">305</td>
<td align="right">600</td>
<td align="right">176</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">E02003037</td>
<td align="left">E02003043</td>
<td align="right">1186</td>
<td align="right">88</td>
<td align="right">908</td>
<td align="right">110</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">E02003034</td>
<td align="left">E02003043</td>
<td align="right">1177</td>
<td align="right">281</td>
<td align="right">711</td>
<td align="right">100</td>
<td align="right">7</td>
</tr>
</tbody>
</table>
<p>This table provides a snapshot of Bristolian travel patterns. It demonstrates that walking is the most popular mode of transport among the top 5 origin-destination pairs, that zone <code>E02003043</code> is a popular destination (Bristol city centre, the destination of all the top 5 OD pairs), and that the <em>intrazonal</em> trips, from one part of zone <code>E02003043</code> to another, constitute the most travelled OD pair in the dataset. But from a policy perspective <a href="transport.html#tab:od">8.1</a> is of limited use: aside from the fact that it contains only a tiny portion of the 2910 OD pairs, it tells us little about <em>where</em> policy measures are needed. What is needed is a way to plot this origin-destination data on the map.</p>
<p>The solution is to convert the non-geographic <code>od</code> dataset into geographical desire lines that can be plotted on a map. The geographic representation of the <em>interzonal</em> OD pairs (in which the destination is different from the origin) presented in Table <a href="transport.html#tab:od">8.1</a> are displayed as straight black lines in <a href="transport.html#fig:desire">8.3</a>. These are clearly more useful from a policy perspective. The conversion from <code>data.frame</code> to <code>sf</code> class is done by the <strong>stplanr</strong> function <code>od2line()</code>, which matches the IDs in the first two columns of the <code>od</code> object to the <code>zone_code</code> ID column in the geographic <code>zones</code> object.<a href="#fn49" class="footnoteRef" id="fnref49"><sup>49</sup></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">od_intra =<span class="st"> </span><span class="kw">filter</span>(od, o ==<span class="st"> </span>d)
od_inter =<span class="st"> </span><span class="kw">filter</span>(od, o !=<span class="st"> </span>d)
desire_lines =<span class="st"> </span><span class="kw">od2line</span>(od_inter, zones)
<span class="co">#&gt; Warning in st_centroid.sfc(st_geometry(x), of_largest_polygon =</span>
<span class="co">#&gt; of_largest_polygon): st_centroid does not give correct centroids for</span>
<span class="co">#&gt; longitude/latitude data</span></code></pre></div>
<p>The first two lines of the preceding code chunk split the <code>od</code> dataset into two mutually exclusive objects, <code>od_intra</code> (which only contrains OD pairs representing intrazone trips) and <code>od_inter</code> (which represents interzonal travel). The third line generates a geographic object <code>desire_lines</code> (of class <code>sf</code>) that allows the interzone trips to be visualized geographically, using plot commands such as that provided in the command below. An illustration of the results are presented in Figure <a href="transport.html#fig:desire">8.3</a> (we will cover the visualization methods that produced this plot in a subsequent chapter). The map shows the city center dominate transport patterns in the region, suggesting policies should be prioritised there, although a number of peripheral sub-centers can also be seen. <!-- These include Bradford Stoke to the North and Portishead to the West. --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(desire_lines$geometry, <span class="dt">lwd =</span> desire_lines$all /<span class="st"> </span><span class="dv">500</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:desire"></span>
<img src="figures/desire-1.png" alt="Desire lines representing trip patterns in the Bristol Travel to Work Area. The 4 black lines represent interzonal OD pairs in Table 8.1." width="576" />
<p class="caption">
Figure 8.3: Desire lines representing trip patterns in the Bristol Travel to Work Area. The 4 black lines represent interzonal OD pairs in Table 8.1.
</p>
</div>
</div>
<div id="routes" class="section level2">
<h2><span class="header-section-number">8.5</span> Routes</h2>
<p>From a geographical perspective routes are desire lines that are no longer straight: the origin and destination points are the same, but the pathway to get from A to B is more complex. Desire lines contain only two vertices (their beginning and end points) but routes can contain hundreds of vertices if they cover a large distance or represent travel patterns on an intricate road network (routes on simple grid-based road networks require relatively few vertices).</p>
<p>Routes are generated from desire lines — or more commonly origin-destination pairs — using routing algorithms. Routing algorithms can either run locally or remotely. Local routing is computationally intensive because requires having a representation of the route network stored on your computer (we will see how in section <a href="transport.html#route-networks">8.7</a>). Remote routing services use an API to receive queries about origin and destination points, and then return the results over the internet. There are many advantages of using remote routing services, including the fact that they can be up-to-date, have global coverage, and run on a set-up that was designed for the job, explaining this section’s focus on online routing services. Before proceeding, however, you should be aware of the disadvantages of online routing services: they can be slow due to their reliance on internet connections and expensive. <!-- Todo: add link to Mark's presentation on dodgr vs Google routing costs (RL) --></p>
<p>A popular and free (for limited uses) routing service is the Open Source Routing Machine (<a href="http://project-osrm.org/">OSRM</a>). Instead of routing <em>all</em> desire lines generated in the previous section, which would be time and memory-consuming, we will focus attention on only the desire lines of policy interest. The benefits of cycling trips are greatest when they replace car trips. Clearly not all car trips can realistically be replaced by cycling, but 5 km Euclidean distance (or around 6-8 km of route distance) is easily accessible within 30 minutes for most people. Based on this reasoning <!-- Todo: add references supporting this (RL) --> we will only route desire lines along which a high (300+) number of car trips take place that are up to 5 km in distance:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">desire_lines$distance =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">st_length</span>(desire_lines))
desire_carshort =<span class="st"> </span><span class="kw">filter</span>(desire_lines, car_driver &gt;<span class="st"> </span><span class="dv">300</span>, distance &lt;<span class="st"> </span><span class="dv">5000</span>)
route_carshort =<span class="st"> </span><span class="kw">line2route</span>(desire_carshort, <span class="dt">route_fun =</span> route_osrm)</code></pre></div>
<p>We could keep the new <code>route_carshort</code> object separate from the straight line representation of the same trip in <code>desire_carshort</code> but, from a data management perspective, it makes more sense to combine them: they represent the same trip. The new route dataset contains <code>distance</code> (referring to route distance this time) and <code>duration</code> fields (in seconds) which could be useful. However, for the purposes of this chapter we are only interested in the geometry, from which route distance can be calculated. The following command makes use of the ability of simple features objects to contain multiple geographic columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">desire_carshort$geom_car =<span class="st"> </span>route_carshort$geometry</code></pre></div>
<p>This allows for the desire lines along which many short car journeys take place to be plotted alongside likely routes travelled by cars, with the width of the routes proportional to the number of car journeys that could potentially be replaced. The code below results in Figure <a href="transport.html#fig:routes">8.4</a>, which demonstrates along which routes people are driving short distances:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(desire_carshort$geometry)
<span class="kw">plot</span>(desire_carshort$geom_car, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:routes"></span>
<img src="figures/routes-1.png" alt="Routes along which many (300+) short (&lt;5km Euclidean distance) car journeys are made (red) overlaying desire lines representing the same trips (black)." width="576" />
<p class="caption">
Figure 8.4: Routes along which many (300+) short (&lt;5km Euclidean distance) car journeys are made (red) overlaying desire lines representing the same trips (black).
</p>
</div>
<p>The results show that the short desire lines along which most people travel by car are geographically clustered. Plotting the results on an interactive map, for example with <code>mapview::mapview(desire_carshort)</code>, reveals that these car trips take place in and around Bradley Stoke. According to <a href="https://en.wikipedia.org/wiki/Bradley_Stoke">Wikipedia</a>, Bradley Stoke is “Europe’s largest new town built with private investment”, which may help why its high level of car dependency via limitted public transport provision. The proliferation of short car journeys in this area can also be understood in terms of the surrounding transport infrastructure:</p>
<blockquote>
<p>Bradley Stoke housing development of 8500 homes constructed by volume house builders; and major transport nodes such as junctions on both the M4 and M5 motorways <span class="citation">(Tallon <a href="#ref-tallon_bristol_2007">2007</a>)</span>.</p>
</blockquote>
<p>There are many benefits of converting travel desire lines into likely routes of travel from a policy perspective, primary among them the ability to understand what it is about the surrounding environment that makes people travel by a particular mode. We discuss future directions of research building on the routes in section <a href="transport.html#future-directions-of-travel">8.8</a>. For the purposes of this case study, suffice to say that the roads along which these short car journeys travel should be prioritised for investigation to understand how they can be made more conducive to sustainable transport modes. One option would be to add new public transport nodes to the network. Such nodes are described in the next section.</p>
</div>
<div id="nodes-on-the-transport-system" class="section level2">
<h2><span class="header-section-number">8.6</span> Nodes on the transport system</h2>
<p>Nodes in geographic transport data are zero dimensional features (points) among the predominantly one dimensional features (lines) that comprise the network. There are two types of transport nodes:</p>
<ol style="list-style-type: decimal">
<li>Nodes not directly on the network such as zone centroids — covered in the next section — or individual origins and destinations such as houses and workplaces.</li>
<li>Nodes that are a part of transport networks, representing individual pathways, intersections between pathways (junctions) and points for entering or exiting a transport network such as bus stops and train stations.</li>
</ol>
<p>From a mathematical perspective transport networks are simply large graphs. The first type of node can be connected to the network with “centroid connectors” <span class="citation">(Hollander <a href="#ref-hollander_transport_2016">2016</a>)</span>, the geographic location of which can influence model results, by simulating excessive traffic on streets surrounding zone centroids <span class="citation">(Jafari et al. <a href="#ref-jafari_investigation_2015">2015</a>)</span>. The second type of nodes are nodes on this graph, each of which is connected by one or more straight ‘edges’ that represent individual segments on the network. We will see how transport networks can be represented as mathematical graphs in section <a href="transport.html#route-networks">8.7</a>.</p>
<p>Public transport stops are particularly important nodes that can represented as either type of node: a bus stop that is part of a road, or a large rail station that is represented by its pedestrian entry point hundreds of meters from railway tracks, to take a couple of examples. We will use railway stations to illustrate public transport nodes, in relation to the research question of increasing cycling in Bristol. These stations are loaded as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rail_stations =<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;extdata/rail_stations.rds&quot;</span>)</code></pre></div>
<p>A common barrier preventing people from switching away from cars for commuting to work is that the distance from home to work is too far to walk or cycle. Public transport can reduce this barrier by providing an fast and high-volume option for common routes into cities. From an active travel perspective public transport ‘legs’ of longer journeys divide trips into three:</p>
<!-- Add image to show this if needs be (RL) -->
<ul>
<li>The origin leg, typically from residential areas to public transport stations.</li>
<li>The public transport leg, which typically goes from the station nearest a trip’s origin to the station nearest its destination.</li>
<li>The destination leg, from the station of alighting to the destination.</li>
</ul>
<p>Building on the analysis conducted in section <a href="transport.html#desire-lines">8.4</a>, public transport nodes can be used to construct three-part desire lines for trips that can be taken by bus and (the mode used in this example) rail. The first stage is to identify the desire lines with most public transport travel, which in this case can be directly because number of trips by train is a variable in the desire lines (the public transport potential could also be estimated using public transport routing services such as <a href="http://www.opentripplanner.org/">OpenTripPlanner</a>). For clarity of method we’ll select just the top three desire lines in terms of rails use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">desire_rail =<span class="st"> </span><span class="kw">top_n</span>(desire_lines, <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">wt =</span> train)</code></pre></div>
<p>The challenge now is to ‘break-up’ each of these lines into three pieces, representing travel via public transport nodes. This can be done by converting multiline objects in which each feature contains 3 line geometries representing origin, public transport and destination legs of the trip. The first stage is to create matrices of coordinates that will subsequently be used to create matrices representing each leg:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mat_orig =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">line2df</span>(desire_rail)[<span class="kw">c</span>(<span class="st">&quot;fx&quot;</span>, <span class="st">&quot;fy&quot;</span>)])
mat_dest =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">line2df</span>(desire_rail)[<span class="kw">c</span>(<span class="st">&quot;tx&quot;</span>, <span class="st">&quot;ty&quot;</span>)])
mat_rail =<span class="st"> </span><span class="kw">st_coordinates</span>(rail_stations)</code></pre></div>
<p>The outputs are three matrices representing the starting points of the trips, their destinations and possible intermediary points at public transport nodes (named <code>orig</code>, <code>dest</code> and <code>rail</code> respectively). But how to identify <em>which</em> intermediary points to use for each desire line? The <code>knn()</code> function from the <strong>nabor</strong> package (which is used internally by <strong>stplanr</strong> so it should already be installed) solves this problem by finding <em>k nearest neighbors</em> between two sets of coordinates. The function can find any number of nearest neighbors by setting the <code>k</code> parameter, in this case to one:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knn_orig =<span class="st"> </span>nabor::<span class="kw">knn</span>(mat_rail, <span class="dt">query =</span> mat_orig, <span class="dt">k =</span> <span class="dv">1</span>)$nn.idx
knn_dest =<span class="st"> </span>nabor::<span class="kw">knn</span>(mat_rail, <span class="dt">query =</span> mat_dest, <span class="dt">k =</span> <span class="dv">1</span>)$nn.idx</code></pre></div>
<p>This results not in matrices of coordinates, but row indices that can subsequently be used to subset the <code>mat_rail</code>. It is worth taking a look at the results to ensure that the process has worked properly and explain what has happened:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(knn_orig)
<span class="co">#&gt; [1] 28  3  2</span>
<span class="kw">as.numeric</span>(knn_dest)
<span class="co">#&gt; [1] 30 30 30</span></code></pre></div>
<p>The output demonstrates that each object contains three whole numbers (the number of rows in <code>desire_rail</code>) representing the rail station closest to the origin and destination of each desire line. Note that while each ‘origin station’ is different, the destination (station <code>30</code>) is the same for all desire lines. This is to be expected because rail travel in cities tends to converge on a single large station (in this case Bristol Temple Meads). The indices can now be used to create matrices representing the rail station of origin and destination:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mat_rail_o =<span class="st"> </span>mat_rail[knn_orig, ]
mat_rail_d =<span class="st"> </span>mat_rail[knn_dest, ]</code></pre></div>
<p>The final stage is to convert these matrices into meaningful geographic objects, in this case ‘multilinestrings’ that capture the fact that each stage is a separate line, but part of the same overall trip which can be represented as a simple feature:</p>
<!-- Would the subsequent code chunck be better as `lapply()` or `map()` command? -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mats2line =<span class="st"> </span>function(mat1, mat2) {
  <span class="kw">lapply</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(mat1), function(i) {
    <span class="kw">rbind</span>(mat1[i, ], mat2[i, ]) %&gt;%
<span class="st">    </span><span class="kw">st_linestring</span>()
  }) %&gt;%<span class="st"> </span><span class="kw">st_sfc</span>()
}
desire_rail$leg_orig =<span class="st"> </span><span class="kw">mats2line</span>(mat_orig, mat_rail_o)
desire_rail$leg_rail =<span class="st"> </span><span class="kw">mats2line</span>(mat_rail_o, mat_rail_d)
desire_rail$leg_dest =<span class="st"> </span><span class="kw">mats2line</span>(mat_rail_d, mat_dest)</code></pre></div>
<p>Now we are in a position to visualize the results, in Figure <a href="transport.html#fig:stations">8.5</a>: the three initial <code>desire_rail</code> lines now have three additional geometry list-columns representing travel from home to the origin station, from there to the destination, and finally from the destination station to the destination. In this case the destination leg is very short (walking distance) but the origin legs may be sufficiently far to justify investment in cycling infrastructure to encourage people to cycle to the stations on the outward leg of peoples’ journey to work in the residential areas surrounding the three origin stations in Figure <a href="transport.html#fig:stations">8.5</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:stations"></span>
<img src="figures/stations-1.png" alt="Station nodes (red dots) used as intermediary points that convert straight desire lines with high rail usage (black) into three legs: to the origin station (red) via public transport (grey) and to the destination (a very short blue line)." width="576" />
<p class="caption">
Figure 8.5: Station nodes (red dots) used as intermediary points that convert straight desire lines with high rail usage (black) into three legs: to the origin station (red) via public transport (grey) and to the destination (a very short blue line).
</p>
</div>
</div>
<div id="route-networks" class="section level2">
<h2><span class="header-section-number">8.7</span> Route networks</h2>
<p>The data used in this section was downloaded using <strong>osmdata</strong>. To avoid having to request the data from OSM repeatedly, we’ll use a locally saved version of the data, which contains point and line data for the case study area:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ways =<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;extdata/ways.rds&quot;</span>)
<span class="kw">summary</span>(ways)
<span class="co">#&gt;      highway        maxspeed         ref                geometry   </span>
<span class="co">#&gt;  cycleway:1261   30 mph : 822   A38    : 199   LINESTRING   :4591  </span>
<span class="co">#&gt;  rail    : 813   20 mph : 435   M5     : 138   epsg:4326    :   0  </span>
<span class="co">#&gt;  road    :2517   70 mph : 323   A432   : 128   +proj=long...:   0  </span>
<span class="co">#&gt;                  40 mph : 314   A4018  : 120                       </span>
<span class="co">#&gt;                  50 mph : 131   A420   : 112                       </span>
<span class="co">#&gt;                  (Other): 475   (Other):1681                       </span>
<span class="co">#&gt;                  NA&#39;s   :2091   NA&#39;s   :2213</span></code></pre></div>
<p>The above code chunk loaded a simple feature object representing around 3,000 segments on the transport network. This an easily manageable dataset size (transport datasets be large but it’s best to start small).</p>
<p>As mentioned, route networks can usefully be represented as mathematical graphs, with nodes on the network connected by edges. A number of R packages have been developed for dealing with such graphs, notably <strong>igraph</strong>. One can manually convert a route network into an <code>igraph</code> object, but that process risks loosing the geographic attributes. To overcome this issue <code>SpatialLinesNetwork()</code> was developed in the <strong>stplanr</strong> package to represent route networks simultaneously as graphs <em>and</em> a set of geographic lines. This function is demonstrated below using a subset of the <code>ways</code> object used in previous sections.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ways_freeway =<span class="st"> </span>ways %&gt;%<span class="st"> </span><span class="kw">filter</span>(maxspeed ==<span class="st"> &quot;70 mph&quot;</span>) 
ways_sln =<span class="st"> </span><span class="kw">SpatialLinesNetwork</span>(ways_freeway)
<span class="kw">slotNames</span>(ways_sln)
<span class="co">#&gt; [1] &quot;sl&quot;          &quot;g&quot;           &quot;nb&quot;          &quot;weightfield&quot;</span>
<span class="kw">weightfield</span>(ways_sln)
<span class="co">#&gt; [1] &quot;length&quot;</span>
<span class="kw">class</span>(ways_sln@g)
<span class="co">#&gt; [1] &quot;igraph&quot;</span></code></pre></div>
<p>The output of the previous code chunk shows that <code>ways_sln</code> is a composite object with various ‘slots’. These include: the spatial component of the network (named <code>sl</code>), the graph component (<code>g</code>) and the ‘weightfield’, the edge variable used for shortest path calculation (by default segment distance). <code>ways_sln</code> is of class <code>sfNetwork</code>, defined by the S4 class system. This means that each component can be accessed using the <code>@</code> operator, which is used below to extract its graph component and process it using the <strong>igraph</strong> package, before plotting the results in geographic space. In the example below the ‘edge betweeness’ is calculated, with the results demonstrating that each graph edge represents a segment: the segments near the center of the road network have the greatest betweeness scores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g =<span class="st"> </span>ways_sln@g
e =<span class="st"> </span>igraph::<span class="kw">edge_betweenness</span>(ways_sln@g)
<span class="kw">plot</span>(ways_sln@sl$geometry, <span class="dt">lwd =</span> e /<span class="st"> </span><span class="dv">500</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-27-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>One can also find the shortest route between origins and destinations using this graph representation of the route network:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">path =<span class="st"> </span><span class="kw">sum_network_routes</span>(ways_sln, <span class="dv">1</span>, <span class="dv">20</span>, <span class="st">&quot;length&quot;</span>)
<span class="kw">plot</span>(path$geometry, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">10</span>)
<span class="kw">plot</span>(ways_sln@sl$geometry, <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-29-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="future-directions-of-travel" class="section level2">
<h2><span class="header-section-number">8.8</span> Future directions of travel</h2>
<p>This chapter has provided a taster of the possibilities of using geocomputation for transport research. It has explored some of key geographic features of the travel patterns in a major city using open data to identify where investment in sustainable transport options may be most urgently needed. More importantly from a learning perspective, it has demonstrated how representing transport systems at multiple interacting geographical levels can lead to new insights about how they work, and how to change them. However there is much more that could be done in this area. Geocomputation for transport applications is a small but rapidly growing field and space requirements mean that we have only scratched the surface of what is possible, while emphasising the principles and key methods of implementation in R.</p>
<p>It is possible to build on the foundations presented in this chapter in many directions. Transport is the fastest growing source of greenhouse gas emissions in many countries. Because of the highly unequal distribution of transport-related emissions across society, and the fact that transport (unlike food and heating) is not essential for wellbeing, there is great potential for the sector to rapidly decarbonise through demand reduction, electrification of the vehicle fleet and the uptake of active travel modes such as walking and cycling. Further exploration of such ‘transport futures’ represents a particularly promising future direction of travel from a policy perspective.</p>
<p>From a methods perspective there are also many directions one could go in. <!-- Something on lines, routes, route networks (RL) --> Characteristics of the route such as speed limits, busyness and the provision of protected cycling and walking paths may be able to help explain differences in ‘mode-split’ (the proportion of trips made by different modes of transport). By aggregating OpenStreetMap data (downloaded using methods presented in Chapter <a href="read-write.html#read-write">6</a>) using buffers and spatial data methods presented in Chapters <a href="attr.html#attr">3</a> and <a href="spatial-operations.html#spatial-operations">4</a>, for example, it would be possible to detect the presence of green space in close proximity to parks. Using R’s statistical modelling capabilities this could then be used to predict the current number of using a certain mode along particular desire lines, and how that may switch under scenarios of change. A similar approach was used to create the Propensity to Cycle Tool (PCT), a publicly accessible mapping tool developed in R to prioritize investment in cycling, available at <a href="http://www.pct.bike/">pct.bike/</a> <span class="citation">(Lovelace et al. <a href="#ref-lovelace_propensity_2017">2017</a>)</span>. Similar tools could be used to encourage evidence-based policies around other modes, not just cycling.</p>
<p>One growing area of interest surrounds the simulation of individual people and vehicles on the road network using techniques such as spatial microsimulation and agent-based modelling (ABM). R has the capability to model people in zones, and interface with ABM software such as NetLogo. Combined with its geographical capabilities, demonstrated in this book, R would seem an appropriate language for such developments to take place. Of course this should be done in ways that build-on and extend existing work in the area. R’s ‘ecological niche’ in transport modelling software could be around the integration of detailed geographic analysis techniques with more widely known and used statistical techniques used in transport research.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-miller_toblers_2004">
<p>Miller, Harvey J. 2004. “Tobler’s First Law and Spatial Analysis.” <em>Annals of the Association of American Geographers</em> 94 (2).</p>
</div>
<div id="ref-rodrigue_geography_2013">
<p>Rodrigue, Jean-Paul, Claude Comtois, and Brian Slack. 2013. <em>The Geography of Transport Systems</em>. 3 edition. London ; New York: Routledge.</p>
</div>
<div id="ref-horni_multi-agent_2016">
<p>Horni, Andreas, Kai Nagel, and Kay W. Axhausen. 2016. <em>The Multi-Agent Transport Simulation MATSim</em>. Ubiquity Press. <a href="https://www.ubiquitypress.com/site/books/10.5334/baw/" class="uri">https://www.ubiquitypress.com/site/books/10.5334/baw/</a>.</p>
</div>
<div id="ref-hollander_transport_2016">
<p>Hollander, Yaron. 2016. <em>Transport Modelling for a Complete Beginner</em>. CTthink!</p>
</div>
<div id="ref-bristol_city_council_deprivation_2015">
<p>Bristol City Council. 2015. “Deprivation in Bristol 2015.” Bristol City Council. <a href="https://www.bristol.gov.uk/statistics-census-information/deprivation" class="uri">https://www.bristol.gov.uk/statistics-census-information/deprivation</a>.</p>
</div>
<div id="ref-coombes_efficient_1986">
<p>Coombes, M. G., A. E. Green, and S. Openshaw. 1986. “An Efficient Algorithm to Generate Official Statistical Reporting Areas: The Case of the 1984 Travel-to-Work Areas Revision in Britain.” <em>The Journal of the Operational Research Society</em> 37 (10): 943. doi:<a href="https://doi.org/10.2307/2582282">10.2307/2582282</a>.</p>
</div>
<div id="ref-tallon_bristol_2007">
<p>Tallon, Andrew R. 2007. “Bristol.” <em>Cities</em> 24 (1): 74–88. doi:<a href="https://doi.org/10.1016/j.cities.2006.10.004">10.1016/j.cities.2006.10.004</a>.</p>
</div>
<div id="ref-jafari_investigation_2015">
<p>Jafari, Ehsan, Mason D. Gemar, Natalia Ruiz Juri, and Jennifer Duthie. 2015. “Investigation of Centroid Connector Placement for Advanced Traffic Assignment Models with Added Network Detail.” <em>Transportation Research Record: Journal of the Transportation Research Board</em> 2498 (June): 19–26. doi:<a href="https://doi.org/10.3141/2498-03">10.3141/2498-03</a>.</p>
</div>
<div id="ref-lovelace_propensity_2017">
<p>Lovelace, Robin, Anna Goodman, Rachel Aldred, Nikolai Berkoff, Ali Abbas, and James Woodcock. 2017. “The Propensity to Cycle Tool: An Open Source Online System for Sustainable Transport Planning.” <em>Journal of Transport and Land Use</em> 10 (1). doi:<a href="https://doi.org/10.5198/jtlu.2016.862">10.5198/jtlu.2016.862</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="47">
<li id="fn47"><p>In cases where the first match does not provide the right name, the country or region should be specified, for example <code>Bristol Tennessee</code> for an America Bristol.<a href="transport.html#fnref47">↩</a></p></li>
<li id="fn48"><p>the <code>_if</code> affix requires a <code>TRUE</code>/<code>FALSE</code> question to be asked of the variables, in this case ‘is it numeric?’ and only variables returning true are summarized.<a href="transport.html#fnref48">↩</a></p></li>
<li id="fn49"><p>Note that the operation emits a warning: this is <code>od2line()</code> works by allocating the start and end points of each origin-destination pair to the <em>centroid</em> of its zone of origin and destination. This represents a straight line between the centroid of zone <code>E02003047</code> and the centroid of <code>E02003043</code> for the second origin-destination pair represented in Table <a href="transport.html#tab:od">8.1</a>, for example. For real-world use one would use centroid values generated from projected data or, preferably, use <em>population-weighted</em> centroids. <!-- Todo: add PCT reference (RL) --><a href="transport.html#fnref49">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="location.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Robinlovelace/geocompr/edit/master/08-transport.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
